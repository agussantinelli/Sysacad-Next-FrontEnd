<app-page-layout title="Cambio de Contraseña">
    <div class="change-password-container">
        <div class="header">
            <h2>Seguridad de la Cuenta</h2>
            <p class="subtitle">Actualiza tu contraseña para mantener tu cuenta segura</p>
        </div>

        <form [formGroup]="passwordForm" (ngSubmit)="onSubmit()" class="password-form">

            <!-- Current Password -->
            <div class="form-group">
                <label for="currentPassword">Contraseña Actual</label>
                <div class="input-wrapper">
                    <span class="material-icons input-icon">lock</span>
                    <input type="password" id="currentPassword" formControlName="currentPassword" class="form-input"
                        placeholder="Ingresa tu contraseña actual">
                </div>
                @if (passwordForm.get('currentPassword')?.touched && passwordForm.get('currentPassword')?.invalid) {
                <span class="error-message">La contraseña actual es requerida</span>
                }
            </div>

            <!-- New Password -->
            <div class="form-group">
                <label for="newPassword">Nueva Contraseña</label>
                <div class="input-wrapper">
                    <span class="material-icons input-icon">key</span>
                    <input type="password" id="newPassword" formControlName="newPassword" class="form-input"
                        placeholder="Mínimo 6 caracteres">
                </div>
                @if (passwordForm.get('newPassword')?.touched && passwordForm.get('newPassword')?.errors) {
                @if (passwordForm.get('newPassword')?.errors?.['required']) {
                <span class="error-message">La nueva contraseña es requerida</span>
                }
                @if (passwordForm.get('newPassword')?.errors?.['minlength']) {
                <span class="error-message">Debe tener al menos 6 caracteres</span>
                }
                }
            </div>

            <!-- Confirm New Password -->
            <div class="form-group">
                <label for="confirmPassword">Confirmar Nueva Contraseña</label>
                <div class="input-wrapper">
                    <span class="material-icons input-icon">check_circle</span>
                    <input type="password" id="confirmPassword" formControlName="confirmPassword" class="form-input"
                        placeholder="Repite la nueva contraseña">
                </div>
                @if (passwordForm.get('confirmPassword')?.touched) {
                @if (passwordForm.get('confirmPassword')?.errors?.['required']) {
                <span class="error-message">Debes confirmar la contraseña</span>
                }
                @if (passwordForm.errors?.['mismatch']) {
                <span class="error-message">Las contraseñas no coinciden</span>
                }
                }
            </div>

            <div class="form-actions">
                <button type="button" class="btn-cancel" (click)="goBack()">
                    Cancelar
                </button>
                <button type="submit" class="btn-submit" [disabled]="passwordForm.invalid || isLoading">
                    @if (isLoading) {
                    <span class="material-icons spin">refresh</span> Procesando...
                    } @else {
                    Actualizar Contraseña
                    }
                </button>
            </div>
        </form>
    </div>
</app-page-layout>